<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bible Verse Touch Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fffaf0;
      text-align: center;
      padding: 20px;
    }

    h1 {
      font-size: 32px;
      color: #2e5a78;
    }

    #bank, #slots {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      min-height: 100px;
      padding: 10px;
      margin: 20px auto;
      max-width: 1000px;
    }

    .tile, .slot {
      background: #d0ebff;
      border-radius: 10px;
      padding: 10px 15px;
      margin: 8px;
      font-size: 22px;
      min-width: 60px;
      text-align: center;
      user-select: none;
      touch-action: none;
    }

    .tile {
      cursor: grab;
      position: relative;
      z-index: 10;
    }

    .slot {
      background: #f0fff0;
      border: 2px dashed #bbb;
      min-height: 50px;
      min-width: 100px;
    }

    .message {
      font-size: 24px;
      color: green;
      margin-top: 20px;
    }

    button {
      margin: 10px;
      font-size: 18px;
      padding: 10px 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
    }

    #controls {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Bible Verse Builder – Isaiah 41:10</h1>
  <div id="bank"></div>
  <h3>Drag the pieces into the correct order:</h3>
  <div id="slots"></div>
  <div class="message" id="message"></div>

  <div id="controls">
    <button onclick="checkAnswer()">Check</button>
    <button onclick="nextLevel()">Next Level</button>
    <button onclick="backToLevel1()">Back to Level 1</button>
    <button onclick="resetGame()">Reset</button>
  </div>

  <script>
    const levels = [
      [
        "Do not fear, for I am with you.",
        "Do not be dismayed, for I am your God.",
        "I will strengthen you and help you.",
        "I will uphold you with my righteous right hand.",
        "Isaiah 41:10"
      ],
      [
        "Do not fear,",
        "for I am with you.",
        "Do not be dismayed,",
        "for I am your God.",
        "I will strengthen you",
        "and help you.",
        "I will uphold you",
        "with my righteous right hand.",
        "Isaiah 41:10"
      ],
      [
        "Do", "not", "fear,", "for", "I", "am", "with", "you.",
        "Do", "not", "be", "dismayed,", "for", "I", "am", "your", "God.",
        "I", "will", "strengthen", "you", "and", "help", "you.",
        "I", "will", "uphold", "you", "with", "my", "righteous", "right", "hand.",
        "Isaiah", "41:10"
      ]
    ];

    let currentLevel = 0;
    let correctOrder = levels[currentLevel];

    function shuffle(arr) {
      let array = arr.slice();
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function resetGame() {
      const bank = document.getElementById('bank');
      const slots = document.getElementById('slots');
      const message = document.getElementById('message');
      message.textContent = '';

      bank.innerHTML = '';
      slots.innerHTML = '';

      correctOrder = levels[currentLevel];
      const shuffled = shuffle(correctOrder);

      shuffled.forEach(text => {
        const tile = document.createElement('div');
        tile.className = 'tile';
        tile.textContent = text;
        tile.setAttribute('draggable', false);
        addDragLogic(tile);
        bank.appendChild(tile);
      });

      for (let i = 0; i < correctOrder.length; i++) {
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.dataset.index = i;
        slots.appendChild(slot);
      }
    }

    function addDragLogic(el) {
      let offsetX, offsetY, currentDrop = null;

      function onTouchStart(e) {
        const touch = e.touches[0];
        offsetX = touch.clientX - el.getBoundingClientRect().left;
        offsetY = touch.clientY - el.getBoundingClientRect().top;
        el.style.position = 'absolute';
        el.style.zIndex = 1000;
        document.body.appendChild(el);
        moveAt(touch.pageX, touch.pageY);
        document.addEventListener('touchmove', onTouchMove, { passive: false });
        document.addEventListener('touchend', onTouchEnd);
        e.preventDefault();
      }

      function moveAt(pageX, pageY) {
        el.style.left = pageX - offsetX + 'px';
        el.style.top = pageY - offsetY + 'px';
      }

      function onTouchMove(e) {
        const touch = e.touches[0];
        moveAt(touch.pageX, touch.pageY);
        el.hidden = true;
        const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
        el.hidden = false;
        if (!elemBelow) return;
        const dropSlot = elemBelow.closest('.slot');
        currentDrop = dropSlot || null;
      }

      function onTouchEnd() {
        document.removeEventListener('touchmove', onTouchMove);
        document.removeEventListener('touchend', onTouchEnd);
        if (currentDrop && currentDrop.children.length === 0) {
          currentDrop.appendChild(el);
          el.style.position = 'static';
          el.style.left = '';
          el.style.top = '';
          el.style.zIndex = '';
        } else {
          document.getElementById('bank').appendChild(el);
          el.style.position = 'static';
        }
        checkAnswer();
      }

      el.addEventListener('touchstart', onTouchStart);

      el.addEventListener('mousedown', function (e) {
        offsetX = e.clientX - el.getBoundingClientRect().left;
        offsetY = e.clientY - el.getBoundingClientRect().top;
        el.style.position = 'absolute';
        el.style.zIndex = 1000;
        document.body.appendChild(el);
        moveAt(e.pageX, e.pageY);
        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
      });

      function onMouseMove(e) {
        moveAt(e.pageX, e.pageY);
        el.hidden = true;
        const elemBelow = document.elementFromPoint(e.clientX, e.clientY);
        el.hidden = false;
        currentDrop = elemBelow?.closest('.slot') || null;
      }

      function onMouseUp() {
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup', onMouseUp);
        if (currentDrop && currentDrop.children.length === 0) {
          currentDrop.appendChild(el);
          el.style.position = 'static';
          el.style.left = '';
          el.style.top = '';
          el.style.zIndex = '';
        } else {
          document.getElementById('bank').appendChild(el);
          el.style.position = 'static';
        }
        checkAnswer();
      }
    }

    function checkAnswer() {
      const slots = document.querySelectorAll('.slot');
      const current = Array.from(slots).map(s => s.textContent.trim());
      if (current.join('') === correctOrder.join('')) {
        document.getElementById('message').textContent = '✅ Great job! You completed the verse!';
      } else {
        document.getElementById('message').textContent = '';
      }
    }

    function nextLevel() {
      if (currentLevel < levels.length - 1) {
        currentLevel++;
        resetGame();
      }
    }

    function backToLevel1() {
      currentLevel = 0;
      resetGame();
    }

    resetGame();
  </script>
</body>
</html>