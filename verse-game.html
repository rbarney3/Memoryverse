<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bible Verse Touch Game</title>
  <style>
    body {
      font-family: "Comic Sans MS", "Segoe UI", cursive;
      background: #fffaf0;
      text-align: center;
      padding: 20px;
    }

    h1 {
      font-size: 32px;
      color: #2e5a78;
    }

    #bank, #slots {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      min-height: 100px;
      padding: 10px;
      margin: 20px auto;
      max-width: 1000px;
    }

    .tile, .slot {
      background: #d0ebff;
      border-radius: 10px;
      padding: 10px 15px;
      margin: 8px;
      font-size: 22px;
      min-width: 60px;
      text-align: center;
      user-select: none;
      touch-action: none;
    }

    .tile {
      cursor: grab;
      position: relative;
      z-index: 10;
    }

    .slot {
      background: #f0fff0;
      border: 2px dashed #bbb;
      min-height: 50px;
      min-width: 100px;
    }

    .message {
      font-size: 24px;
      color: green;
      margin-top: 20px;
    }

    button {
      margin: 10px;
      font-size: 20px;
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1 id="title">Bible Verse Builder – Isaiah 41:10</h1>
  <div id="bank"></div>
  <h3>Drag the pieces into the correct order:</h3>
  <div id="slots"></div>
  <div class="message" id="message"></div>
  <button onclick="checkAnswer()">Check</button>
  <button onclick="resetGame()">Reset</button>
  <button onclick="nextLevel()">Next Level</button>

  <script>
    const levels = [
      {
        title: "Isaiah 41:10",
        verse: [
          "Do not fear, for I am with you.",
          "Do not be dismayed, for I am your God.",
          "I will strengthen you and help you.",
          "I will uphold you with my righteous right hand.",
          "Isaiah 41:10"
        ]
      },
      {
        title: "John 3:16",
        verse: [
          "For God so loved the world",
          "that he gave his one and only Son,",
          "that whoever believes in him shall not perish",
          "but have eternal life.",
          "John 3:16"
        ]
      },
      {
        title: "Philippians 4:13",
        verse: [
          "I can do all things",
          "through Christ",
          "who strengthens me.",
          "Philippians 4:13"
        ]
      }
    ];

    let levelIndex = 0;
    let correctOrder = [];

    function shuffle(arr) {
      let array = arr.slice();
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function resetGame() {
      const bank = document.getElementById('bank');
      const slots = document.getElementById('slots');
      const message = document.getElementById('message');
      const title = document.getElementById('title');

      const level = levels[levelIndex];
      correctOrder = [...level.verse];
      title.textContent = `Bible Verse Builder – ${level.title}`;
      message.textContent = '';

      bank.innerHTML = '';
      slots.innerHTML = '';

      const shuffled = shuffle(correctOrder);
      shuffled.forEach(text => {
        const tile = document.createElement('div');
        tile.className = 'tile';
        tile.textContent = text;
        tile.setAttribute('draggable', false);
        addDragLogic(tile);
        bank.appendChild(tile);
      });

      for (let i = 0; i < correctOrder.length; i++) {
        const slot = document.createElement('div');
        slot.className = 'slot';
        slot.dataset.index = i;
        slots.appendChild(slot);
      }
    }

    function nextLevel() {
      levelIndex = (levelIndex + 1) % levels.length;
      resetGame();
    }

    function addDragLogic(el) {
      let offsetX, offsetY, currentDrop = null;

      function moveAt(x, y) {
        el.style.left = x - offsetX + 'px';
        el.style.top = y - offsetY + 'px';
      }

      function onTouchStart(e) {
        const touch = e.touches[0];
        offsetX = touch.clientX - el.getBoundingClientRect().left;
        offsetY = touch.clientY - el.getBoundingClientRect().top;
        el.style.position = 'absolute';
        el.style.zIndex = 1000;
        document.body.appendChild(el);
        moveAt(touch.pageX, touch.pageY);
        document.addEventListener('touchmove', onTouchMove, { passive: false });
        document.addEventListener('touchend', onTouchEnd);
        e.preventDefault();
      }

      function onTouchMove(e) {
        const touch = e.touches[0];
        moveAt(touch.pageX, touch.pageY);
        el.hidden = true;
        const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
        el.hidden = false;
        currentDrop = elemBelow?.closest('.slot') || null;
      }

      function onTouchEnd() {
        document.removeEventListener('touchmove', onTouchMove);
        document.removeEventListener('touchend', onTouchEnd);
        if (currentDrop && currentDrop.children.length === 0) {
          currentDrop.appendChild(el);
          el.style = '';
          checkAnswer();
        } else {
          document.getElementById('bank').appendChild(el);
          el.style = '';
        }
      }

      el.addEventListener('touchstart', onTouchStart);

      el.addEventListener('mousedown', function (e) {
        offsetX = e.clientX - el.getBoundingClientRect().left;
        offsetY = e.clientY - el.getBoundingClientRect().top;
        el.style.position = 'absolute';
        el.style.zIndex = 1000;
        document.body.appendChild(el);
        moveAt(e.pageX, e.pageY);
        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup', onMouseUp);
      });

      function onMouseMove(e) {
        moveAt(e.pageX, e.pageY);
        el.hidden = true;
        const elemBelow = document.elementFromPoint(e.clientX, e.clientY);
        el.hidden = false;
        currentDrop = elemBelow?.closest('.slot') || null;
      }

      function onMouseUp() {
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup', onMouseUp);
        if (currentDrop && currentDrop.children.length === 0) {
          currentDrop.appendChild(el);
          el.style = '';
          checkAnswer();
        } else {
          document.getElementById('bank').appendChild(el);
          el.style = '';
        }
      }
    }

    function checkAnswer() {
      const slots = document.querySelectorAll('.slot');
      const current = Array.from(slots).map(s => s.textContent.trim());
      const message = document.getElementById('message');
      if (current.join('') === correctOrder.join('')) {
        message.textContent = '✅ Great job! You completed the verse!';
      } else {
        message.textContent = '❌ Not quite! Try again.';
      }
    }

    resetGame();
  </script>
</body>
</html>